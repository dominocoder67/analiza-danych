---
title: "analiza danych - samochody"
author: "Dominik Bartosiak, Damian Damięcki, Mikołaj Kustusz"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    self_contained: true
    default_style: "light"
    downcute_theme: "default"
---

```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)
if (!require(tidyverse)) install.packages("tidyverse")
if (!require(dplyr)) install.packages("dplyr")
if (!require(naniar)) install.packages("naniar")
if (!require(ggplot2)) install.packages("ggplot2")
if (!require(VIM)) install.packages("VIM")

library(tidyverse)
library(dplyr)
library(naniar)
library(ggplot2)
library(VIM)

dane <- read_csv("dane/Car_Prices_Poland_Kaggle.csv")
```

# Wstęp

Celem niniejszego raportu jest analiza danych dotyczących cen samochodów w Polsce. Dane zostały pozyskane z platformy Kaggle i zawierają informacje na temat różnych modeli samochodów, ich cech oraz cen rynkowych. Analiza ma na celu zrozumienie czynników wpływających na ceny samochodów oraz identyfikację wzorców i trendów w danych.

## Opis danych

Zestaw danych pochodzi z jednego z największych portali ogłoszeniowych w Polsce. Zgromadzono w nim ponad 200 tysięcy ofert sprzedaży samochodów, obejmujących szeroki zakres marek, modeli, parametrów technicznych oraz informacji o stanie pojazdu.

Celem zbioru jest umożliwienie analizy cen, cech technicznych, profilu ofert i trendów rynkowych dotyczących samochodów używanych i nowych dostępnych na polskim rynku.

### Pytania badawcze

1.  **Jakie są średnie ceny samochodów w zależności od marki i modelu?**
2.  **Które cechy samochodów (np. rok produkcji, przebieg, moc silnika, rodzaj paliwa) mają największy wpływ na cenę pojazdu?**
3.  **Jak zmieniają się ceny samochodów w zależności od roku produkcji? Czy starsze samochody tanieją liniowo czy nieliniowo?**
4.  **Czy istnieją różnice w cenach samochodów w zależności od typu pojazdu (np. sedan, SUV, hatchback, kombi)?**
5.  **Czy samochody używane różnią się istotnie ceną od samochodów nowych po uwzględnieniu innych cech pojazdu?**
6.  **Jak przebieg pojazdu wpływa na jego cenę i czy wpływ ten różni się między markami?**
7.  **Czy rodzaj paliwa (benzyna, diesel, LPG, hybryda, elektryczny) wpływa na cenę, a jeśli tak — które paliwo jest najdroższe na rynku wtórnym?**
8.  **Czy kolor samochodu ma wpływ na jego cenę? Jeśli tak, które kolory są wyceniane najwyżej?**
9.  **Jak lokalizacja oferty wpływa na cenę samochodu? Czy w dużych miastach auta są droższe niż w małych miejscowościach?**
10. **Które kombinacje cech (np. moc + przebieg, rok + pojemność silnika) najlepiej przewidują cenę samochodu?**

## Analiza danych

## 2.1 Braki danych

```{r}
procent <- prop_complete_var(dane) * 100
```

W danych znajduje się `r procent` % kompletnych wartości.

```{r}
VIM::aggr(dane, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(dane), cex.axis=.7, gap=3, ylab=c("Procent braków danych","Wzorzec braków danych"))
 
```

## Imputacje danych

```{r}
dane_imp <- hotdeck(dane)
VIM::aggr(dane_imp, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(dane_imp), cex.axis=.7, gap=3, ylab=c("Procent braków danych po imputacji","Wzorzec braków danych po imputacji"))
```
Po imputacji danych za pomocą metody hotdeck, wszystkie braki danych zostały uzupełnione.
